module ietf-ucl-acl {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-ucl-acl";
  prefix uacl;

  import ietf-access-control-list {
    prefix acl;
    reference
      "RFC 8519: YANG Data Model for Network Access
                 Control Lists (ACLs)";
  }
  import ietf-schedule {
    prefix schedule;
    reference
      "RFC XXXX: A Policy-based Network Access Control";
  }
  organization
    "IETF OPSWG Working Group";
  contact
    "WG Web: <https://datatracker.ietf.org/wg/opsawg/>
     WG List: <mailto:opsawg@ietf.org>";
  description
    "This YANG module defines XXX.

     Copyright (c) 2023 IETF Trust and the persons identified
     as authors of the code. All rights reserved.

     Redistribution and use in source and binary forms, with
     or without modification, is permitted pursuant to, and
     subject to the license terms contained in, the Revised
     BSD License set forth in Section 4.c of the IETF Trust's
     Legal Provisions Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC XXXX
     (https://www.rfc-editor.org/info/rfcXXXX); see the RFC
     itself for full legal notices.";

  revision 2023-01-19 {
    description
      "Initial revision.";
    reference
      "RFC XXXX: A Policy-based Network Access Control";
  }

  feature match-on-endpoint-group {
    description
      "The device can support matching on endpoint groups.";
  }

  feature match-on-time {
    description
      "The device can support a time-based condition match.";
  }

  augment "/acl:acls/acl:acl" {
    description
      "add a new container to store endpoint group information.";
    container endpoint-groups {
      description
        "Container definition for the endpoint group.";
      list endpoint-group {
        key "endpoint-group-id";
        description
          "Definition of the endpoint group list.";
        leaf endpoint-group-id {
          type uint32 {
            range "0..4294967294";
          }
          description
            "The endpoint group ID that uniquely identifies an
             endpoint group.";
        }
        choice group-type {
          description
            "Choice of each different type of endpoint.";
          case user-group {
            description
              "The employee that actually connects to the network.";
            container user-group {
              description
                "Defines the user-group container.";
              leaf role {
                type string;
                description
                  "The common role of this user-group.";
              }
            }
          }
          case device-group {
            description
              "The static resources in a network, such as a specific
               application.";
            container device-group {
              description
                "Defines the device-group container.";
              leaf device-type {
                type string;
                description
                  "The type of the static resource.";
              }
            }
          }
        }
      }
    }
  }

  augment "/acl:acls/acl:acl/acl:aces/acl:ace/acl:matches" {
    description
      "Add another choice to allow ace match based on endpoint group
       id.";
    container endpoint-group {
      if-feature "match-on-endpoint-group";
      description
        "Add new match types.";
      container source-match {
        description
          "The source matched information.";
        leaf endpoint-group-id {
          type leafref {
            path "../../../../../../endpoint-groups/endpoint-group/"+
                 "endpoint-group-id";
          }
          description
            "The matched source endpoint group ID.";
        }
      }
      container destination-match {
        description
          "The destination matched information.";
        leaf endpoint-group-id {
          type leafref {
            path "../../../../../../endpoint-groups/endpoint-group/"+
                 "endpoint-group-id";
          }
          description
            "The matched destination endpoint group ID.";
        }
      }
    }
  }

  augment "/acl:acls/acl:acl/acl:aces/acl:ace" {
    if-feature "match-on-time";
    description
      "Add a new parameter to the Access Control Entry (ACE).";
    container time-range {
      description
        "This container defines when the access control
         entry rules are in effect.

         If it is not configured, the access control entry
         is immediately and always in effect.";
      choice time-range-type {
        description
          "Choice based on the type of the time range.";
        case periodic-range {
          description
            "A periodic range of time to take effect.";
          uses schedule:recurrence;
        }
        case absolute-range {
          description
            "A single precise period of time to take effect.";
          uses schedule:period;
        }
      }
    }
  }
}
