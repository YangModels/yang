<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Network Access Control List (ACL) YANG Data  Model</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Definitions and Acronyms"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Problem Statement"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Design of the ACL Model"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 ACL Modules"/>
<link href="#rfc.section.4" rel="Chapter" title="4 ACL YANG Models"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 IETF Access Contorl List module"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 IETF-PACKET-FIELDS module"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 An ACL Example"/>
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Port Range Usage Example"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Linux nftables"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations"/>
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Acknowledgements"/>
<link href="#rfc.references" rel="Chapter" title="9 References"/>
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Extending ACL model examples"/>
<link href="#rfc.appendix.A.1" rel="Chapter" title="A.1 Example of extending existing model for route filtering"/>
<link href="#rfc.appendix.A.2" rel="Chapter" title="A.2 A company proprietary module example"/>
<link href="#rfc.appendix.A.3" rel="Chapter" title="A.3 Attaching Access Control List to interfaces"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Bogdanovic, D., Sreenivasa, K., Huang, L., and D. Blair" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-netmod-acl-model-03" />
  <meta name="dct.issued" scheme="ISO8601" content="2015-10-11" />
  <meta name="dct.abstract" content="This document describes a data model of Access Control List (ACL) basic building blocks.  " />
  <meta name="description" content="This document describes a data model of Access Control List (ACL) basic building blocks.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">NETMOD WG</td>
  <td class="right">D. Bogdanovic</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right"></td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">K. Sreenivasa</td>
</tr>
<tr>
  <td class="left">Expires: April 13, 2016</td>
  <td class="right">Brocade Communications System</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">L. Huang</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Juniper Networks</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">D. Blair</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Cisco Systems</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">October 11, 2015</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Network Access Control List (ACL) YANG Data  Model<br />
  <span class="filename">draft-ietf-netmod-acl-model-03</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document describes a data model of Access Control List (ACL) basic building blocks.  </p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 13, 2016.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2015 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Definitions and Acronyms</a></li>
</ul><li>2.   <a href="#rfc.section.2">Problem Statement</a></li>
<li>3.   <a href="#rfc.section.3">Design of the ACL Model</a></li>
<ul><li>3.1.   <a href="#rfc.section.3.1">ACL Modules</a></li>
</ul><li>4.   <a href="#rfc.section.4">ACL YANG Models</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">IETF Access Contorl List module</a></li>
<li>4.2.   <a href="#rfc.section.4.2">IETF-PACKET-FIELDS module</a></li>
<li>4.3.   <a href="#rfc.section.4.3">An ACL Example</a></li>
<li>4.4.   <a href="#rfc.section.4.4">Port Range Usage Example</a></li>
</ul><li>5.   <a href="#rfc.section.5">Linux nftables</a></li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a></li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a></li>
<li>8.   <a href="#rfc.section.8">Acknowledgements</a></li>
<li>9.   <a href="#rfc.references">References</a></li>
<ul><li>9.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Extending ACL model examples</a></li>
<ul><li>A.1.   <a href="#rfc.appendix.A.1">Example of extending existing model for route filtering</a></li>
<li>A.2.   <a href="#rfc.appendix.A.2">A company proprietary module example</a></li>
<li>A.3.   <a href="#rfc.appendix.A.3">Attaching Access Control List to interfaces</a></li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a></h1>
<p id="rfc.section.1.p.1">Access Control List (ACL) is one of the basic elements to configure device forwarding behavior.  It is used in many networking concepts such as Policy Based Routing, Firewalls etc.</p>
<p id="rfc.section.1.p.2">An ACL is an ordered set of rules that is used to filter traffic on a networking device.  Each rule is represented by an Access Control Entry (ACE).</p>
<p id="rfc.section.1.p.3">Each ACE has a group of match criteria and a group of action criteria.</p>
<p id="rfc.section.1.p.4">The match criteria consist of a tuple of packet header match criteria and metadata match criteria.</p>
<p/>

<ul>
  <li>Packet header matches apply to fields visible in the packet such as address or class of service or port numbers.</li>
  <li>Metadata matches apply to fields associated with the packet but not in the packet header such as input interface or overall packet length</li>
</ul>

<p> </p>
<p id="rfc.section.1.p.6">The actions specify what to do with the packet when the matching criteria is met. These actions are any operations that would apply to the packet,  such as counting, policing, or simply forwarding.The list of potential actions is endless depending on the innovations of the networked devices.</p>
<p id="rfc.section.1.p.7">Access Control List is also widely knowns as ACL (pronounce as [ak-uh l]) or Access List.  In this document, Access Control List, ACL and Access List are interchangeable.</p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> Definitions and Acronyms</h1>
<p id="rfc.section.1.1.p.1">ACE: Access Control Entry</p>
<p id="rfc.section.1.1.p.2">ACL: Access Control List</p>
<p id="rfc.section.1.1.p.3">AFI: Address Field Identifier</p>
<p id="rfc.section.1.1.p.4">DSCP: Differentiated Services Code Point</p>
<p id="rfc.section.1.1.p.5">ICMP: Internet Control Message Protocol</p>
<p id="rfc.section.1.1.p.6">IP: Internet Protocol</p>
<p id="rfc.section.1.1.p.7">IPv4: Internet Protocol version 4</p>
<p id="rfc.section.1.1.p.8">IPv6: Internet Protocol version 6</p>
<p id="rfc.section.1.1.p.9">MAC: Media Access Control</p>
<p id="rfc.section.1.1.p.10">TCP: Transmission Control Protocol</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#problem" id="problem">Problem Statement</a></h1>
<p id="rfc.section.2.p.1">This document defines a YANG <a href="#RFC6020">[RFC6020]</a> data model for the configuration of ACLs. It is very important that model can be easily reused between vendors and between applications.</p>
<p id="rfc.section.2.p.2">ACL implementations in every device may vary greatly in terms of the filter constructs and actions that they support. Therefore this draft proposes a simple model that can be augmented by standard extensions and vendor proprietary models. </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#design" id="design">Design of the ACL Model</a></h1>
<p id="rfc.section.3.p.1">Although different vendors have different ACL data models, there is a common understanding of what access control list (ACL) is. A network system usually have a list of ACLs, and each ACL contains an ordered list of rules, also known as access list entries &#8211; ACEs. Each ACE has a group of match criteria and a group of action criteria. The match criteria consist of packet header matching and metadata matching.  Packet header matching applies to fields visible in the packet such as address or class of service or port numbers.  Metadata matching applies to fields associated with the packet, but not in the packet header such as input interface, packet length, or source or destination prefix length. The actions can be any sort of operation from logging to rate limiting or dropping to simply forwarding. Actions on the first matching ACE are applied with no processing of subsequent ACEs. The model also includes a container to hold overall operational state for each ACL and operational state for each ACE. One ACL can be applied to multiple targets within the device, such as interfaces of a networked device, applications or features running in the device, etc. When applied to interfaces of a networked device, the ACL is applied in a direction which indicates if it should be applied to packet entering (input) or leaving the device (output). An example in the appendix shows how to express it in YNAG model.</p>
<p id="rfc.section.3.p.2">This draft tries to address the commonalities between all vendors and create a common model, which can be augmented with proprietary models.  The base model is very simple and with this design we hope to achieve needed flexibility for each vendor to extend the base model.</p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#aclmodules" id="aclmodules">ACL Modules</a></h1>
<p id="rfc.section.3.1.p.1">There are two YANG modules in the model. The first module, "ietf-access-control-list", defines generic ACL aspects which are common to all ACLs regardless of their type or vendor. In effect, the module can be viewed as providing a generic ACL "superclass". It imports the second module, "ietf-packet-fields". The match container in "ietf-access-control-list" uses groupings in "ietf-packet-fields". If there is a need to define new "matches" choice, such as IPFIX <a href="#RFC5101">[RFC5101]</a>, the container "matches" can be augmented.</p>
<div id="rfc.figure.1"/>
<div id="ietf-acl-tree"/>
<pre>
module: ietf-access-control-list
   +--rw access-lists
      +--rw acl* [acl-type acl-name]
         +--ro acl-oper-data
         +--rw access-list-entries
         |  +--rw ace* [rule-name]
         |     +--rw matches
         |     |  +--rw (ace-type)?
         |     |  |  +--:(ace-ip)
         |     |  |  |  +--rw (ace-ip-version)?
         |     |  |  |  |  +--:(ace-ipv4)
         |     |  |  |  |  |  +--rw destination-ipv4-network?       inet:ipv4-prefix
         |     |  |  |  |  |  +--rw source-ipv4-network?            inet:ipv4-prefix
         |     |  |  |  |  +--:(ace-ipv6)
         |     |  |  |  |     +--rw destination-ipv6-network?       inet:ipv6-prefix
         |     |  |  |  |     +--rw source-ipv6-network?            inet:ipv6-prefix
         |     |  |  |  |     +--rw flow-label?                     inet:ipv6-flow-label
         |     |  |  |  +--rw dscp?                           inet:dscp
         |     |  |  |  +--rw protocol?                       uint8
         |     |  |  |  +--rw source-port-range
         |     |  |  |  |  +--rw lower-port    inet:port-number
         |     |  |  |  |  +--rw upper-port?   inet:port-number
         |     |  |  |  +--rw destination-port-range
         |     |  |  |     +--rw lower-port    inet:port-number
         |     |  |  |     +--rw upper-port?   inet:port-number
         |     |  |  +--:(ace-eth)
         |     |  |     +--rw destination-mac-address?        yang:mac-address
         |     |  |     +--rw destination-mac-address-mask?   yang:mac-address
         |     |  |     +--rw source-mac-address?             yang:mac-address
         |     |  |     +--rw source-mac-address-mask?        yang:mac-address
         |     |  +--rw input-interface?                string
         |     |  +--rw absolute-time
         |     |     +--rw start?    yang:date-and-time
         |     |     +--rw end?      yang:date-and-time
         |     |     +--rw active?   boolean
         |     +--rw actions
         |     |  +--rw (packet-handling)?
         |     |     +--:(deny)
         |     |     |  +--rw deny?     empty
         |     |     +--:(permit)
         |     |        +--rw permit?   empty
         |     +--ro ace-oper-data
         |     |  +--ro match-counter?   yang:counter64
         |     +--rw rule-name        string
         +--rw acl-name               string
         +--rw acl-type               acl-type
          </pre>
<p class="figure">Figure 1</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#yangmodel" id="yangmodel">ACL YANG Models</a></h1>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#ietfacl" id="ietfacl">IETF Access Contorl List module</a></h1>
<p id="rfc.section.4.1.p.1">"ietf-access-control-list" is the standard top level module for Access lists. The "access-lists" container stores a list of "acl". Each "acl" has information identifying the access list by a name("acl-name") and a list("access-list-entries") of rules associated with the "acl-name". Each of the entries in the list("access-list-entries"), indexed by the string "rule-name", has containers defining "matches" and "actions". The "matches" define criteria used to identify patterns in "ietf-packet-fields". The "actions" define behavior to undertake once a "match" has been identified.</p>
<pre>
&lt;CODE BEGINS&gt;file "ietf-access-control-list@2015-10-11.yang"
module ietf-access-control-list {
  yang-version 1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-access-control-list";
  prefix acl;
  import ietf-yang-types {
    prefix yang;
  }
  import ietf-packet-fields {
    prefix packet-fields;
  }
  organization "IETF NETMOD (NETCONF Data Modeling Language) 
           Working Group";
  contact
    "WG Web: http://tools.ietf.org/wg/netmod/
    WG List: netmod@ietf.org
    WG Chair: Juergen Schoenwaelder
    j.schoenwaelder@jacobs-university.de
    WG Chair: Tom Nadeau
    tnadeau@lucidvision.com
    Editor: Dean Bogdanovic
    ivandean@gmail.com
    Editor: Kiran Agrahara Sreenivasa
    kkoushik@brocade.com
    Editor: Lisa Huang
    lyihuang@juniper.net
    Editor: Dana Blair
    dblair@cisco.com";
  description
    "This YANG module defines a component that describing the
    configuration of Access Control Lists (ACLs).
    Copyright (c) 2015 IETF Trust and the persons identified as
    the document authors.  All rights reserved.
    Redistribution and use in source and binary forms, with or
    without modification, is permitted pursuant to, and subject
    to the license terms contained in, the Simplified BSD
    License set forth in Section 4.c of the IETF Trust's Legal
    Provisions Relating to IETF Documents
    (http://trustee.ietf.org/license-info).
    This version of this YANG module is part of RFC XXXX; see
    the RFC itself for full legal notices.";
  revision 2015-03-17 {
    description
      "Base model for Network Access Control List (ACL).";
    reference
      "RFC XXXX: Network Access Control List (ACL)
      YANG Data  Model";
  }
  identity acl-base {
    description
      "Base Access Control List type for all Access Control List type
      identifiers.";
  }
  identity ipv4-acl {
    base acl:acl-base;
    description 
       "ACL that primarily matches on fields from the IPv4 header
       (e.g. IPv4 destination address) and layer 4 headers (e.g. TCP
       destination port).  An acl of type ipv4-acl does not contain 
       matches on fields in the ethernet header or the IPv6 header.";
  }
  identity ipv6-acl {
    base acl:acl-base;
    description
      "ACL that primarily matches on fields from the IPv6 header
      (e.g. IPv6 destination address) and layer 4 headers (e.g. TCP
      destination port). An acl of type ipv6-acl does not contain 
      matches on fields in the ethernet header or the IPv4 header.";
  }
  identity eth-acl {
    base acl:acl-base;
    description
      "ACL that primarily matches on fields in the ethernet header, 
      like 10/100/1000baseT or WiFi Access Control List. An acl of 
      type eth-acl does not contain matches on fields in the IPv4 
      header, IPv6 header or layer 4 headers.";
  }
  typedef acl-type {
    type identityref {
      base acl-base;
    }
    description
      "This type is used to refer to an Access Control List
      (ACL) type";
  }
  typedef access-control-list-ref {
    type leafref {
      path "/access-lists/acl/acl-name";
    }
    description
      "This type is used by data models that need to reference an
      Access Control List";
  }
  container access-lists {
    description
      "This is a top level container for Access Control Lists. 
      It can have one or more Access Control Lists.";
    list acl {
      key "acl-type acl-name";
      description
        "An Access Control List(ACL) is an ordered list of
        Access List Entries (ACE). Each Access Control Entry has a
        list of match criteria and a list of actions.
        Since there are several kinds of Access Control Lists
        implemented with different attributes for
        different vendors, this
        model accommodates customizing Access Control Lists for
        each kind and for each vendor.";
      container acl-oper-data {
        config false;
        description
          "Overall Access Control List operational data";
      }
      container access-list-entries {
        description
          "The access-list-entries container contains
          a list of access-list-entries(ACE).";
        list ace {
          key "rule-name";
          ordered-by user;
          description
            "List of access list entries(ACE)";
          container matches {
            description
              "Definitions for match criteria for this Access List 
        Entry.";
            choice ace-type {
              description
                "Type of access list entry.";
              case ace-ip {
                      description "IP Access List Entry.";
                choice ace-ip-version {
                  description
                    "IP version used in this Acess List Entry.";
                  case ace-ipv4 {
                    uses packet-fields:acl-ipv4-header-fields;
                  }
                  case ace-ipv6 {
                    uses packet-fields:acl-ipv6-header-fields;
                  }
                }
                uses packet-fields:acl-ip-header-fields;
              }
              case ace-eth {
                description
                  "Ethernet Access List entry.";
                uses packet-fields:acl-eth-header-fields;
              }
            }
            uses packet-fields:metadata;
          }
          container actions {
            description
              "Definitions of action criteria for this Access List 
        Entry.";
            choice packet-handling {
              default "deny";
              description
                "Packet handling action.";
              case deny {
                leaf deny {
                  type empty;
                  description
                    "Deny action.";
                }
              }
              case permit {
                leaf permit {
                  type empty;
                  description
                    "Permit action.";
                }
              }
            }
          }
          container ace-oper-data {
            config false;
            description
              "Operational data for this Access List Entry.";
            leaf match-counter {
              type yang:counter64;
              description
                "Number of matches for this Access List Entry";
            }
          }
          leaf rule-name {
            type string;
            description
              "A unique name identifying this Access List 
              Entry(ACE).";
          }
        }
      }
      leaf acl-name {
        type string;
        description
          "The name of access-list. A device MAY restrict the length 
    	  and value of this name, possibly space and special 
    	  characters are not allowed.";
      }
      leaf acl-type {
        type acl-type;
        description
	    "Type of access control list. Indicates the primary intended
	    type of match criteria (e.g. ethernet, IPv4, IPv6, mixed, etc)
	    used in the list instance.";
      }
    }
  }
}
&lt;CODE ENDS&gt;
        </pre>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#pktheaders" id="pktheaders">IETF-PACKET-FIELDS module</a></h1>
<p id="rfc.section.4.2.p.1">The packet fields module defines the necessary groups for matching on fields in the packet including ethernet, ipv4, ipv6, transport layer fields and metadata. Since the number of match criteria is very large, the base draft does not include these directly but references them by "uses" to keep the base module simple. In case more match conditions are needed, those can be added by augmenting choices within container "matches" in ietf-access-control-list.yang model</p>
<pre>
&lt;CODE BEGINS&gt;file "ietf-packet-fields@2015-06-11.yang"
module ietf-packet-fields {
  yang-version 1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-packet-fields";
  prefix packet-fields;
  import ietf-inet-types {
    prefix inet;
  }
  import ietf-yang-types {
    prefix yang;
  }
  organization "IETF NETMOD (NETCONF Data Modeling Language) Working 
                Group";
  contact
    "WG Web: http://tools.ietf.org/wg/netmod/
    WG List: netmod@ietf.org
    WG Chair: Juergen Schoenwaelder
    j.schoenwaelder@jacobs-university.de
    WG Chair: Tom Nadeau
    tnadeau@lucidvision.com
    Editor: Dean Bogdanovic
    deanb@juniper.net
    Editor: Kiran Agrahara Sreenivasa
    kkoushik@brocade.com
    Editor: Lisa Huang
    lyihuang@juniper.net
    Editor: Dana Blair
    dblair@cisco.com";
  description
    "This YANG module defines groupings that are used by 
    ietf-access-control-list YANG module. Their usage is not 
    limited to ietf-access-control-list and can be
    used anywhere as applicable.
    Copyright (c) 2015 IETF Trust and the persons identified as
    the document authors.  All rights reserved.
    Redistribution and use in source and binary forms, with or
    without modification, is permitted pursuant to, and subject
    to the license terms contained in, the Simplified BSD
    License set forth in Section 4.c of the IETF Trust's Legal
    Provisions Relating to IETF Documents
    (http://trustee.ietf.org/license-info).
    This version of this YANG module is part of RFC XXXX; see
    the RFC itself for full legal notices.";
  revision 2015-06-11 {
    description
      "Initial version of packet fields used by
      ietf-access-control-list";
    reference
      "RFC XXXX: Network Access Control List (ACL)
      YANG Data  Model";
  }
  grouping acl-transport-header-fields {
    description
      "Transport header fields";
    container source-port-range {
      presence &#8220;Enables setting source port range&#8221;;
      description
        "Inclusive range representing source ports to be used.
        When only lower-port is present, it represents a single port.";
      leaf lower-port {
        type inet:port-number;
        mandatory true;
        description
          "Lower boundary for port.";
      }
      leaf upper-port {
        must ". &gt;= ../lower-port" {
          error-message
          "The upper-port must be greater than or equal to lower-port";
        }
        type inet:port-number;
        description
          "Upper boundary for port . If existing, the upper port
          must be greater or equal to lower-port.";
      }
    }
    container destination-port-range {
      presence &#8220;Enables setting destination port range&#8221;;
      description
        "Inclusive range representing destination ports to be used. When 
  only lower-port is present, it represents a single port.";
      leaf lower-port {
        type inet:port-number;
        mandatory true;
        description
          "Lower boundary for port.";
      }
      leaf upper-port {
      must ". &gt;= ../lower-port" {
        error-message
          "The upper-port must be greater than or equal to lower-port";
        }
        type inet:port-number;
        description
          "Upper boundary for port. If existing, the upper port must
          be greater or equal to lower-port";
      }
    }
  }
  grouping acl-ip-header-fields {
    description
      "IP header fields common to ipv4 and ipv6";
    leaf dscp {
      type inet:dscp;
      description
        "Value of dscp.";
    }
    leaf protocol {
      type uint8;
      description
        "Internet Protocol number.";
    }
    uses acl-transport-header-fields;
  }
  grouping acl-ipv4-header-fields {
    description
      "Fields in IPv4 header.";
    leaf destination-ipv4-network {
      type inet:ipv4-prefix;
      description
        "Destination IPv4 address prefix.";
    }
    leaf source-ipv4-network {
      type inet:ipv4-prefix;
      description
        "Source IPv4 address prefix.";
    }
  }
  grouping acl-ipv6-header-fields {
    description
      "Fields in IPv6 header";
    leaf destination-ipv6-network {
      type inet:ipv6-prefix;
      description
        "Destination IPv6 address prefix.";
    }
    leaf source-ipv6-network {
      type inet:ipv6-prefix;
      description
        "Source IPv6 address prefix.";
    }
    leaf flow-label {
      type inet:ipv6-flow-label;
      description
        "IPv6 Flow label.";
    }
    reference
      "RFC 4291: IP Version 6 Addressing Architecture
      RFC 4007: IPv6 Scoped Address Architecture
      RFC 5952: A Recommendation for IPv6 Address Text Representation";
  }
  grouping acl-eth-header-fields {
    description
      "Fields in Ethernet header.";
    leaf destination-mac-address {
      type yang:mac-address;
      description
        "Destination IEEE 802 MAC address.";
    }
    leaf destination-mac-address-mask {
      type yang:mac-address;
      description
        "Destination IEEE 802 MAC address mask.";
    }
    leaf source-mac-address {
      type yang:mac-address;
      description
        "Source IEEE 802 MAC address.";
    }
    leaf source-mac-address-mask {
      type yang:mac-address;
      description
        "Source IEEE 802 MAC address mask.";
    }
    reference
      "IEEE 802: IEEE Standard for Local and Metropolitan Area
      Networks: Overview and Architecture.";
  }
  grouping timerange {
    description
      "Time range contains time
      segments to allow access-control-list to be
      active/inactive when the system time
      is between the range.";
    container absolute-time {
      description
        "Absolute time and date that
        the associated function starts
        going into effect.";
      leaf start {
        type yang:date-and-time;
        description
          "Absolute start time and date";
      }
      leaf end {
        type yang:date-and-time;
        description
          "Absolute end time and date";
      }
      leaf active {
        type boolean;
        default "true";
        description
          "This object indicates whether the
          the ACL will be active(true) or
          inactive(false) during this time range.";
      }
    }
  }
  grouping metadata {
    description
      "Fields associated with a packet whick are not in
      the header.";
    leaf input-interface {
      type string;
      description
        "Packet was received on this interface.";
    }
    uses timerange;
  }
}
&lt;CODE ENDS&gt;
          </pre>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> <a href="#example" id="example">An ACL Example</a></h1>
<p id="rfc.section.4.3.p.1">Requirement: Deny All traffic from 10.10.10.1 bound for host 10.10.10.255 from leaving.</p>
<p id="rfc.section.4.3.p.2">In order to achieve the requirement, an name Access Control List is needed. The acl and aces can be described in CLI as the following:</p>
<pre>
	    access-list ip sample-ip-acl
	    deny tcp host 10.10.10.1 host 10.10.10.255
	  </pre>
<p id="rfc.section.4.3.p.3">Here is the example acl configuration xml:</p>
<pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
  &lt;data xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
    &lt;access-lists xmlns="urn:ietf:params:xml:ns:yang:ietf-access-control-list"&gt;
      &lt;acl&gt;
        &lt;acl-oper-data /&gt;
	&lt;access-list-entries&gt;
	  &lt;ace&gt;
	    &lt;matches&gt;
	      &lt;destination-ipv4-network&gt;
		10.10.10.255/24
	      &lt;/destination-ipv4-network&gt;
	      &lt;source-ipv4-network&gt;
	        10.10.10.1/24
	      &lt;/source-ipv4-network&gt;
	      &lt;destination-ipv6-network /&gt;
	      &lt;source-ipv6-network /&gt;
	      &lt;flow-label /&gt;
	      &lt;dscp /&gt;
	      &lt;protocol /&gt;
	      &lt;source-port-range&gt;
	        &lt;lower-port /&gt;
	        &lt;upper-port /&gt;
	      &lt;/source-port-range&gt;
	      &lt;destination-port-range&gt;
	        &lt;lower-port /&gt;
	        &lt;upper-port /&gt;
	      &lt;/destination-port-range&gt;
	      &lt;destination-mac-address /&gt;
	      &lt;destination-mac-address-mask /&gt;
	      &lt;source-mac-address /&gt;
	      &lt;source-mac-address-mask /&gt;
	      &lt;input-interface /&gt;
	      &lt;absolute-time&gt;
	        &lt;start /&gt;
	        &lt;end /&gt;
	      &lt;/absolute-time&gt;
	    &lt;/matches&gt;
	    &lt;actions&gt;
	      &lt;deny /&gt;
	      &lt;permit /&gt;
	    &lt;/actions&gt;
	    &lt;ace-oper-data&gt;
	      &lt;match-counter /&gt;
	    &lt;/ace-oper-data&gt;
	    &lt;rule-name&gt;rule1&lt;rule-name/&gt;
	  &lt;/ace&gt;
	&lt;/access-list-entries&gt;
        &lt;acl-name&gt;sample-ipv4-acl&lt;acl-name/&gt;
        &lt;acl-type&gt;ipv4-acl&lt;acl-type/&gt;
      &lt;/acl&gt;
    &lt;/access-lists&gt;
  &lt;/data&gt;
     </pre>
<h1 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a> <a href="#portrange" id="portrange">Port Range Usage Example</a></h1>
<p id="rfc.section.4.4.p.1">When a lower-port and an upper-port are both present, it represents a range between lower-port and upper-port with both the lower-port and upper-port are included. When only a lower-port presents, it represents a single port.  </p>
<p id="rfc.section.4.4.p.2">With the follow XML snippet: </p>
<pre>
     &lt;source-port-range&gt;
       &lt;lower-port&gt;16384&lt;/lower-port&gt;
       &lt;upper-port&gt;16387&lt;/upper-port&gt;
     &lt;/source-port-range&gt;

      </pre>
<p id="rfc.section.4.4.p.3">This represents source ports 16384,16385, 16386, and 16387.  </p>
<p id="rfc.section.4.4.p.4">With the follow XML snippet: </p>
<pre>
      &lt;source-port-range&gt;
        &lt;lower-port&gt;16384&lt;/lower-port&gt;
        &lt;upper-port&gt;65535&lt;/upper-port&gt;
      &lt;/source-port-range&gt;

    </pre>
<p id="rfc.section.4.4.p.5">This represents source ports greater than/equal to 16384.</p>
<p id="rfc.section.4.4.p.6">With the follow XML snippet:</p>
<pre>
      &lt;source-port-range&gt;
        &lt;lower-port&gt;21&lt;/lower-port&gt;
      &lt;/source-port-range&gt;

    </pre>
<p id="rfc.section.4.4.p.7">This represents port 21.  </p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#nftables" id="nftables">Linux nftables</a></h1>
<p id="rfc.section.5.p.1">As Linux platform is becoming more popular as networking platform, the Linux data model is changing. Previously ACLs in Linux were highly protocol specific and different utilities were used (iptables, ip6tables, arptables, ebtables), so each one had separate data model.  Recently, this has changed and a single utility, nftables, has been developed. With a single application, it has a single data model for filewall filters and it follows very similarly to the ietf-access-control list module proposed in this draft. The nftables support input and output ACEs and each ACE can be defined with match and action.  </p>
<p id="rfc.section.5.p.2">In the example below, it shows nftable configuration that accepts and count packets. It contains a </p>
<pre>
	  table ip filter {
            chain output {
              type filter hook output priority 0;
              counter packets 1 bytes 84 accept
            }
	  }
	</pre>
<p id="rfc.section.5.p.3">There are many similarities between Linux nftables and IETF ACL YANG data models. It should be fairly easy to do translation between ACL YANG model described in this draft and Linux nftables.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#security" id="security">Security Considerations</a></h1>
<p id="rfc.section.6.p.1">The YANG module defined in this memo is designed to be accessed via the NETCONF protocol [RFC6241] <a href="#RFC6241">[RFC6241]</a>.  The lowest NETCONF layer is the secure transport layer and the mandatory-to-implement secure transport is SSH [RFC6242] <a href="#RFC6242">[RFC6242]</a>.  The NETCONF access control model [RFC6536] <a href="#RFC6536">[RFC6536]</a> provides the means to restrict access for particular NETCONF users to a pre-configured subset of all available NETCONF protocol operations and content.</p>
<p id="rfc.section.6.p.2">There are a number of data nodes defined in the YANG module which are writable/creatable/deletable (i.e., config true, which is the default).  These data nodes may be considered sensitive or vulnerable in some network environments.  Write operations (e.g.,  &lt;edit-config&gt;) to these data nodes without proper protection can have a negative effect on network operations.</p>
<p id="rfc.section.6.p.3">These are the subtrees and data nodes and their sensitivity/vulnerability:</p>
<p id="rfc.section.6.p.4">/access-lists/acl/access-list-entries: This list specifies all the configured access list entries on the device.  Unauthorized write access to this list can allow intruders to access and control the system. Unauthorized read access to this list can allow intruders to spoof packets with authorized addresses thereby compromising the system.</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#iana" id="iana">IANA Considerations</a></h1>
<p id="rfc.section.7.p.1">This document registers a URI in the IETF XML registry [RFC3688] <a href="#RFC3688">[RFC3688]</a>.  Following the format in RFC 3688, the following registration is requested to be made:</p>
<p id="rfc.section.7.p.2">URI: urn:ietf:params:xml:ns:yang:ietf-access-control-list</p>
<p id="rfc.section.7.p.3">URI: urn:ietf:params:xml:ns:yang:ietf-packet-fields</p>
<p id="rfc.section.7.p.4">Registrant Contact: The IESG.</p>
<p id="rfc.section.7.p.5">XML: N/A, the requested URI is an XML namespace.</p>
<p id="rfc.section.7.p.6">This document registers a YANG module in the YANG Module Names registry [RFC6020].</p>
<p id="rfc.section.7.p.7">name:         ietf-access-control-list namespace:    urn:ietf:params:xml:ns:yang:ietf-access-control-list prefix:       ietf-acl reference:    RFC XXXX </p>
<p id="rfc.section.7.p.8">name:         ietf-packet-fields namespace:    urn:ietf:params:xml:ns:yang:ietf-packet-fields prefix:       ietf-packet-fields reference:    RFC XXXX </p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#ack" id="ack">Acknowledgements</a></h1>
<p id="rfc.section.8.p.1">Alex Clemm, Andy Bierman and Lisa Huang started it by sketching out an initial IETF draft in several past IETF meetings. That draft included an ACL YANG model structure and a rich set of match filters, and acknowledged contributions by Louis Fourie, Dana Blair, Tula Kraiser, Patrick Gili, George Serpa, Martin Bjorklund, Kent Watsen, and Phil Shafer.  Many people have reviewed the various earlier drafts that made the draft went into IETF charter.  </p>
<p id="rfc.section.8.p.2">Dean Bogdanovic, Kiran Agrahara Sreenivasa, Lisa Huang, and Dana Blair each evaluated the YANG model in previous draft separately and then work together, to created a new ACL draft that can be supported by different vendors. The new draft removes vendor specific features, and gives examples to allow vendors to extend in their own proprietary ACL. The earlier draft was superseded with the new one that received more participation from many vendors.  </p>
<p id="rfc.section.8.p.3">Authors would like to thank Jason Sterne, Lada Lhotka, Juergen Schoenwalder for their review of and suggestions to the draft.</p>
<h1 id="rfc.references"><a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC3688">[RFC3688]</b>
      </td>
      <td class="top"><a>Mealling, M.</a>, "<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>", BCP 81, RFC 3688, DOI 10.17487/RFC3688, January 2004.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6020">[RFC6020]</b>
      </td>
      <td class="top"><a>Bjorklund, M.</a>, "<a href="http://tools.ietf.org/html/rfc6020">YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)</a>", RFC 6020, DOI 10.17487/RFC6020, October 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6241">[RFC6241]</b>
      </td>
      <td class="top"><a>Enns, R.</a>, <a>Bjorklund, M.</a>, <a>Schoenwaelder, J.</a> and <a>A. Bierman</a>, "<a href="http://tools.ietf.org/html/rfc6241">Network Configuration Protocol (NETCONF)</a>", RFC 6241, DOI 10.17487/RFC6241, June 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6242">[RFC6242]</b>
      </td>
      <td class="top"><a>Wasserman, M.</a>, "<a href="http://tools.ietf.org/html/rfc6242">Using the NETCONF Protocol over Secure Shell (SSH)</a>", RFC 6242, DOI 10.17487/RFC6242, June 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6536">[RFC6536]</b>
      </td>
      <td class="top"><a>Bierman, A.</a> and <a>M. Bjorklund</a>, "<a href="http://tools.ietf.org/html/rfc6536">Network Configuration Protocol (NETCONF) Access Control Model</a>", RFC 6536, DOI 10.17487/RFC6536, March 2012.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC5101">[RFC5101]</b>
      </td>
      <td class="top"><a>Claise, B.</a>, "<a href="http://tools.ietf.org/html/rfc5101">Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information</a>", RFC 5101, DOI 10.17487/RFC5101, January 2008.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#app-additional" id="app-additional">Extending ACL model examples</a></h1>
<h1 id="rfc.appendix.A.1"><a href="#rfc.appendix.A.1">A.1.</a> <a href="#routeacl" id="routeacl">Example of extending existing model for route filtering</a></h1>
<p id="rfc.section.A.1.p.1">With proposed modular design, it is easy to extend the model with other features. Those features can be standard features, like route filters. Route filters match on specific IP addresses or ranges of prefixes. Much like ACLs, they include some match criteria and corresponding match action(s). For that reason, it is very simple to extend existing ACL model with route filtering. The combination of a route prefix and prefix length along with the type of match determines how route filters are evaluated against incoming routes. Different vendors have different match types and in this model we are using only ones that are common across all vendors participating in this draft.  As in this example, the base ACL model can be extended with company proprietary extensions, described in the next section.  </p>
<pre>
file "example-ext-route-filter@2015-02-14.yang"

module example-ext-route-filter {
  yang-version 1;
  namespace "urn:ietf:params:xml:ns:yang:example-ext-route-filter";
  prefix example-ext-route-filter;
  import ietf-inet-types {
    prefix "inet";
  }
  import ietf-access-control-list {
    prefix "ietf-acl";
  }
organization 
    "Route modele group.";

  contact 
    "abc@abc.com";

  description "
    This module describes route filter as a collection of
    match prefixes. When specifying a match prefix, you
    can specify an exact match with a particular route or
    a less precise match. You can configure either a
    common action that applies to the entire list or an
    action associated with each prefix.
    ";
  revision 2015-05-03 {
    description 
      "Creating Route-Filter extension model based on 
      ietf-access-control-list model";
    reference " ";
  }
  augment "/ietf-acl:access-lists/ietf-acl:acl/
    ietf-acl:access-list-entries/ietf-acl:ace/ietf-acl:matches"{
    description "
      This module augments the matches container in the ietf-acl
      module with route filter specific actions
      ";
    choice route-prefix{
      description "Define route filter match criteria";
      case range {
        description 
          " Route falls between the lower prefix/prefix-length 
          and the upperprefix/prefix-length.";
        choice ipv4-range {
          description "Defines the IPv4 prefix range";
          leaf v4-lower-bound {
            type inet:ipv4-prefix;
            description 
              "Defines the lower IPv4 prefix/prefix length";
          }
          leaf v4-upper-bound {
            type inet:ipv4-prefix;
            description 
              "Defines the upper IPv4 prefix/prefix length";
          }
        }
        choice ipv6-range {
          description "Defines the IPv6 prefix/prefix range";
          leaf v6-lower-bound {
            type inet:ipv6-prefix;
            description 
              "Defines the lower IPv6 prefix/prefix length";
          }
          leaf v6-upper-bound {
            type inet:ipv6-prefix;
            description 
              "Defines the upper IPv6 prefix/prefix length";
          }
        }
      }
    }
  }
}

        </pre>
<h1 id="rfc.appendix.A.2"><a href="#rfc.appendix.A.2">A.2.</a> <a href="#newcoacl" id="newcoacl">A company proprietary module example</a></h1>
<p id="rfc.section.A.2.p.1">Module "example-newco-acl" is an example of company proprietary model that augments "ietf-acl" module. It shows how to use 'augment' with an XPath expression to add additional match criteria, action criteria, and default actions when no ACE matches found. All these are company proprietary extensions or system feature extensions.  "example-newco-acl" is just an example and it is expected from vendors to create their own proprietary models.</p>
<p id="rfc.section.A.2.p.2">The following figure is the tree structure of example-newco-acl.  In this example, /ietf-acl:access-lists/ietf-acl:acl/ietf-acl:access-list-entries/ ietf-acl:ace/ietf-acl:matches are augmented with a new choice, protocol-payload-choice.  The protocol-payload-choice uses a grouping with an enumeration of all supported protocol values. In other example, /ietf-acl:access-lists/ietf-acl:acl/ietf-acl:access-list-entries/ ietf-acl:ace/ietf-acl:actions are augmented with new choice of actions.</p>
<pre>
module: example-newco-acl
  augment /ietf-acl:access-lists/ietf-acl:acl/
    ietf-acl:access-list-entries/ietf-acl:ace/ietf-acl:matches:
   +--rw (protocol-payload-choice)?
      +--:(protocol-payload)
         +--rw protocol-payload* [value-keyword]
            +--rw value-keyword    enumeration
  augment /ietf-acl:access-lists/ietf-acl:acl/
    ietf-acl:access-list-entries/ietf-acl:ace/ietf-acl:actions:
   +--rw (action)?
      +--:(count)
      |  +--rw count?                   string
      +--:(policer)
      |  +--rw policer?                 string
      +--:(hiearchical-policer)
         +--rw hierarchitacl-policer?   string
  augment /ietf-acl:access-lists/ietf-acl:acl:
   +--rw default-actions
      +--rw deny?   empty
          </pre>
<pre>
file "newco-acl@2015-03-04.yang"

module example-newco-acl {
  yang-version 1;

  namespace "urn:newco:params:xml:ns:yang:example-newco-acl";

  prefix example-newco-acl;

  import ietf-acl {
    prefix "ietf-acl";
  }

  revision 2015-05-03{
    description "Creating NewCo proprietary extensions to ietf-acl model";
  }

  augment "/ietf-acl:access-lists/ietf-acl:access-list
    /ietf-acl:access-list-entries/
      ietf-acl:access-list-entry/ietf-acl:matches" {
    description "Newco proprietary simple filter matches";
    choice protocol-payload-choice {
      list protocol-payload {
        key value-keyword;
        ordered-by user;
        description "Match protocol payload";
        uses match-simple-payload-protocol-value;
      }
    }
  }

  augment "/ietf-acl:access-lists/ietf-acl:access-list/
	ietf-acl:access-list-entries/ietf-acl:access-list-entry/
	ietf-acl:actions" {
    description "Newco proprietary simple filter actions";
    choice action {
      case count {
        description "Count the packet in the named counter";
        leaf count {
          type string;
        }
      }
      case policer {
        description "Name of policer to use to rate-limit traffic";
        leaf policer {
          type string;
        }
      }
      case hiearchical-policer {
        description "Name of hierarchical policer to use to
        rate-limit traffic";
        leaf hierarchitacl-policer{
          type string;
        }
      }
    }
  }

  augment "/ietf-acl:access-lists/ietf-acl:access-list" {
    container default-actions {
      description "Actions that occur if no access-list entry is matched.";
      leaf deny {
        type empty;
      }
    }
  }

  grouping match-simple-payload-protocol-value {
    leaf value-keyword {
      description "(null)";
      type enumeration {
        enum icmp {
          description "Internet Control Message Protocol";
        }
        enum icmp6 {
          description "Internet Control Message Protocol Version 6";
        }
        enum range {
          description "Range of values";
        }
      }
    }
  }
}

          </pre>
<p id="rfc.section.A.2.p.3">Draft authors expect that different vendors will provide their own yang models as in the example above, which is the augmentation of the base model</p>
<h1 id="rfc.appendix.A.3"><a href="#rfc.appendix.A.3">A.3.</a> <a href="#interface" id="interface">Attaching Access Control List to interfaces</a></h1>
<p id="rfc.section.A.3.p.1">Access control list typically does not exist in isolation. Instead, they are associated with a certain scope in which they are applied, for example, an interface of a set of interfaces. How to attach an access control list to an interface (or other system artifact) is outside the scope of this model, as it depends on the specifics of the system model that is being applied. However, in general, the general design pattern will involved adding a data node with a reference, or set of references, to ACLs that are to be applied to the interface. For this purpose, the type definition "access-control-list-ref" can be used.</p>
<p id="rfc.section.A.3.p.2">This is an example of attaching an Access Control List to an interface.</p>
<pre>
  import ietf-access-control-list {
    prefix "ietf-acl";
  }
  import ietf-interface {
    prefix "ietf-if";
  }
  import ietf-yang-types {
    prefix "yang";
  }

  augment "/ietf-if:interfaces/ietf-if:interface" {
    description "Apply ACL to interfaces";
    container acl{
      description "ACL related properties.";
      leaf acl-name {
        type ietf-acl:acl-ref;
        mandatory true;
        description "Access Control List name.";
      }
      leaf match-counter {
        type yang:counter64;
        config false;
        description 
          "Total match count for Access Control 
          List on this interface";
      }
      choice direction {
        leaf in { type empty;}
        leaf out { type empty;}
      }
    }
  }
  augment "/ietf-acl:access-lists/ietf-acl:acl/ietf-acl:acl-oper-data" {
    description 
      "This is an example on how to apply acl to a target to collect
      operational data";
    container targets{
      choice interface{
        leaf-list interface-name{
          type ietf-if:interface-ref;
        }
      }
    }
  }
  
          </pre>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dean Bogdanovic</span> 
	  <span class="n hidden">
		<span class="family-name">Bogdanovic</span>
	  </span>
	</span>
	<span class="org vcardline"></span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ivandean@gmail.com">ivandean@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Kiran Agrahara Sreenivasa</span> 
	  <span class="n hidden">
		<span class="family-name">Sreenivasa</span>
	  </span>
	</span>
	<span class="org vcardline">Brocade Communications System</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:kkoushik@brocade.com">kkoushik@brocade.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Lisa Huang</span> 
	  <span class="n hidden">
		<span class="family-name">Huang</span>
	  </span>
	</span>
	<span class="org vcardline">Juniper Networks</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lyihuang@juniper.net">lyihuang@juniper.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dana Blair</span> 
	  <span class="n hidden">
		<span class="family-name">Blair</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dblair@cisco.com">dblair@cisco.com</a></span>

  </address>
</div>

</body>
</html>
