module hncp-topology {

  yang-version 1;

  namespace
    "urn:ietf:params:xml:ns:yang:hncp-topology";

  prefix "hncp";

  import network-topology {
    prefix "nt";
    revision-date 2013-10-21;
  }

  import l3-unicast-igp-topology {
    prefix "l3t";
    revision-date 2013-10-21;
  }

  organization
    "TBD";

  contact "Luka Perkov <lperkov@cisco.com>";

  description
    "This module contains the HNCP topology model";

  revision "2014-08-04" {
    description "Initial version";
    reference "RFC XXXX: A YANG Data Model for HNCP Topology";
  }


  typedef update-sequence-number {
    type uint32;
    description
      "HNCP node number of topology updates";
    reference "ID: Home Networking Control Protocol, sec. 3.";
  }

  typedef age {
    type uint64;
    description
      "HNCP node uptime in milliseconds";
    reference
      "ID: Home Networking Control Protocol, sec. 5.2.3.";
  }

  typedef version {
    type uint32;
    description
      "HNCP node version";
    reference
      "ID: Home Networking Control Protocol, sec. 5.4.";
  }

  typedef user-agent {
    type string;
    description
      "HNCP node user-agent";
    reference
      "ID: Home Networking Control Protocol, sec. 5.4.";
  }

  typedef authoritative {
    type boolean;
    description
      "HNCP prefix authoritative";
    reference
      "ID: Prefix and Address Assignment in a Home Network, " +
      "sec. 6.7.";
  }

  typedef priority {
    type uint16;
    description
      "HNCP prefix priority";
    reference
      "ID: Prefix and Address Assignment in a Home Network, " +
      "sec. 6.8.";
  }

  typedef link {
    type uint32;
    description
      "HNCP prefix link";
    reference
      "ID: Home Networking Control Protocol, sec. 6.";
  }

  typedef link-id {
    type uint32;
    description
      "HNCP address link-id";
    reference
      "ID: Home Networking Control Protocol, sec. 6.";
  }


  grouping hncp-topology-type {
    description
      "HNCP topology type";

    container hncp {
      presence "Indicates HNCP Topology";

      description
        "HNCP topology type";
    }
  }


  augment "/nt:network-topology/nt:topology/" +
          "nt:topology-types/l3t:l3-unicast-igp-topology" {
    description
      "Add support for HNCP";

    uses hncp-topology-type;
  }

  augment "/nt:network-topology/nt:topology/" +
          "nt:node/l3t:igp-node-attributes" {
    when "../../nt:topology-types/l3t:l3-unicast-igp-topology/hncp" {
      description
        "Condition based HNCP extension";
    }
    uses hncp-node-attributes;

    description
      "Add support for HNCP";
  }

  augment "/nt:network-topology/nt:topology/" +
          "nt:node/l3t:igp-node-attributes/l3t:prefix" {
    when "../../../nt:topology-types/" +
         "l3t:l3-unicast-igp-topology/hncp" {
      description
        "Condition based HNCP extension";
    }
    uses hncp-prefix-attributes;

    description
      "Add support for HNCP";
  }

  augment "/nt:network-topology/nt:topology/" +
          "nt:node/nt:termination-point/" +
          "l3t:igp-termination-point-attributes" {
    when "../../../nt:topology-types/" +
         "l3t:l3-unicast-igp-topology/hncp" {
      description
        "Condition based HNCP extension";
    }
    uses hncp-termination-point-attributes;

    description
      "Add support for HNCP";
  }


  grouping hncp-node-attributes {
    description
      "HNCP node attributes";

    container hncp-node-attributes {
      description
        "HNCP node attributes";

      leaf update-sequence-number {
        type update-sequence-number;
        description
          "HNCP node number of topology updates";
      }

      leaf age {
        type age;
        description
          "HNCP node age in milliseconds";
      }

      leaf version {
        type version;
        description
          "HNCP node version";
      }

      leaf user-agent {
        type user-agent;
        description
          "HNCP node user-agent";
      }
    }
  }

  grouping hncp-prefix-attributes {
    description
      "HNCP prefix attributes";

    container hncp-prefix-attributes {
      description
        "HNCP prefix attributes";

      leaf authoritative {
        type authoritative;
        description
          "HNCP prefix authoritative";
      }
      leaf priority {
        type priority;
        description
          "HNCP prefix priority";
      }
      leaf link {
        type link;
        description
          "HNCP prefix link";
      }
    }
  }

  grouping hncp-termination-point-attributes {
    description
      "HNCP termination point attributes";

    container hncp-termination-point-attributes {
      description
        "HNCP termination point attributes";

      leaf link-id {
        type link-id;
        description
          "HNCP address link-id";
      }
    }
  }


  augment "/l3t:igp-node-event" {
    uses hncp-topology-type;
    uses hncp:hncp-node-attributes;

    description
      "HNCP /l3t:igp-node-event extensions";
    reference
      "ID: A YANG Data Model for Network Topologies";
  }

  augment "/l3t:igp-prefix-event" {
    uses hncp-topology-type;
    uses hncp:hncp-prefix-attributes;

    description
      "HNCP /l3t:igp-prefix-event extensions";
    reference
      "ID: A YANG Data Model for Network Topologies";
  }

  augment "/l3t:termination-point-event" {
    uses hncp-topology-type;
    uses hncp:hncp-prefix-attributes;

    description
      "HNCP /l3t:termination-point-event extensions";
    reference
      "ID: A YANG Data Model for Network Topologies";
  }
}
